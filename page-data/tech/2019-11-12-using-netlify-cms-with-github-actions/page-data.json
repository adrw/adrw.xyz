{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/tech/2019-11-12-using-netlify-cms-with-github-actions","result":{"data":{"post":{"__typename":"MdxPost","slug":"/tech/2019-11-12-using-netlify-cms-with-github-actions","title":"Using Netlify CMS with Github Actions","date":"2019-11-12","tags":[{"name":"Tech","slug":"tech"}],"description":null,"canonicalUrl":null,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Using Netlify CMS with Github Actions\",\n  \"date\": \"2019-11-12T18:02:24.125Z\",\n  \"slug\": \"tech/2019-11-12-using-netlify-cms-with-github-actions\",\n  \"tags\": [\"Tech\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Using Netlify CMS with Github Actions\"), mdx(\"p\", null, \"After enjoying the full Netlify ecosystem for the past year, I've come up against their recent changes in build times for free accounts.\"), mdx(\"p\", null, \"Given the recent progression of Github Actions to broader release, I figured I'd give it a shot to move builds back to Github but maintain support for Netlify CMS as a GUI for editing site content.\"), mdx(\"p\", null, \"This ended up being quite the hassle.\"), mdx(\"p\", null, \"So, I've documented the final fix below. \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/adrwxyz/adrw.xyz/commit/a35277bb6e3cf62c9a9125248201e68d9e5b37f6\"\n  }, \"Example commit\"), \".\"), mdx(\"h1\", null, \"Github\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Add a file \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"CNAME\"), \" to your repo with your domain (ie. \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"adrw.xyz\"), \")\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"On master branch, create and push a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gh-pages\"), \" branch\", mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"$ gco -b gh-pages\\n$ git push --set-upstream origin gh-pages\\n\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Turn on Github Pages for this branch in repo settings\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Set it to your existing custom domain\")), mdx(\"h1\", null, \"DNS\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Update domain registrar (ie. Namecheap) with the following new DNS records to point at Github Pages instead of Netlify. Note, use subdomain instead of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"www\"), \" below if it is a subdomain.\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"A     @     185.199.108.153       TTL(Auto)\\nA     @     185.199.109.153       TTL(Auto)\\nA     @     185.199.110.153       TTL(Auto)\\nA     @     185.199.111.153       TTL(Auto)\\nCNAME www   username.github.io.   TTL(Auto)\\n\")))), mdx(\"h1\", null, \"static/admin/config.yml\"), mdx(\"p\", null, \"Update the configuration of Netlify CMS in the repo.\"), mdx(\"h3\", null, \"Before\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"backend:\\n  name: git-gateway\\n  branch: master\\n\")), mdx(\"h3\", null, \"After\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"backend:\\n  name: github\\n  repo: adrw/cook\\n  site_domain: cook.alexanders.xyz\\n  branch: master\\n\")), mdx(\"h1\", null, \"Netlify\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Turn off Netlify Identity (if used).\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Deploys\"), \", stop auto-publishing to prevent the site instance from contributing to your monthly build minutes.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Settings/Build & Deploy\"), \", in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Deploy contexts\"), \", turn off deploy previews.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Settings/Access Control\"), \", add Github as an OAuth authentication provider. You'll need to set up a new OAuth app in Github settings to get the secret values. Use \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"https://api.netlify.com/auth/done\"), \" as the success url.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"In \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Settings/Domain management\"), \", add the value you used for \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"site_domain\"), \" in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"static/admin/config.yml\"), \" as a custom domain. This will allow Netlify's redirect after auth to correctly redirect to the correct domain.\")), mdx(\"h1\", null, \"Resources\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://www.netlifycms.org/docs/authentication-backends/#external-oauth-clients\"\n  }, \"Netlify docs\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://stackoverflow.com/questions/52410225/gatsby-cms-failed-to-load-settings-from-netlify-identity\"\n  }, \"Stack Overflow\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://cnly.github.io/2018/04/14/just-3-steps-adding-netlify-cms-to-existing-github-pages-site-within-10-minutes.html\"\n  }, \"cnly.github.io\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://tylergaw.com/articles/netlify-cms-custom-oath-provider/\"\n  }, \"tylergaw.com\"))));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Using Netlify CMS with Github Actions After enjoying the full Netlify ecosystem for the past year, I've come up against their recent changesâ€¦","timeToRead":1,"banner":null}},"pageContext":{"slug":"/tech/2019-11-12-using-netlify-cms-with-github-actions","formatString":"YYYY-MM-DD"}},"staticQueryHashes":["318001574","3787687951","3787687951"]}